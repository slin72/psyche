(this["webpackJsonpreact-xr-simple-ar-demo"]=this["webpackJsonpreact-xr-simple-ar-demo"]||[]).push([[0],{46:function(e,t,r){},52:function(e,t,r){"use strict";r.r(t);var n=r(37),o=r.n(n),a=r(5),i=r(25),c=(r(46),r(8));function s(e){var t=e.count,r=void 0===t?2e3:t,n=Object(a.useMemo)((function(){for(var e=[],t=0;t<r;t++){var n=4e3,o=2*Math.PI*Math.random(),a=Math.acos(2*Math.random()-1),i=n*Math.cos(o)*Math.sin(a)+(4e3*Math.random()-2e3),c=n*Math.sin(o)*Math.sin(a)+(4e3*Math.random()-2e3),s=n*Math.cos(a)+(2e3*Math.random()-1e3);e.push(i),e.push(c),e.push(s)}return new Float32Array(e)}),[r]);return Object(c.jsxs)("points",{children:[Object(c.jsx)("bufferGeometry",{children:Object(c.jsx)("bufferAttribute",{attachObject:["attributes","position"],count:n.length/3,array:n,itemSize:3})}),Object(c.jsx)("pointsMaterial",{size:3,sizeAttenuation:!0,color:"white",fog:!1})]})}var u=r(11),l=r(10),j=r(0),m=r.p+"static/media/earth.117f05cb.jpg",h=r.p+"static/media/moon.1dd7bdd6.png",d=r.p+"static/media/mars.d5a1f3ac.jpg";function p(){var e=Object(a.useRef)(),t=Object(u.d)(j.TextureLoader,[m,h,d]),r=Object(l.a)(t,3);r[0],r[1],r[2];return Object(u.c)((function(){return e.current.rotation.y=e.current.rotation.y+.01})),Object(c.jsx)("group",{ref:e,scale:[100,100,100],position:[0,0,0],children:Object(c.jsxs)("mesh",{position:[0,0,0],children:[Object(c.jsx)("sphereGeometry",{args:[4,32,32]}),Object(c.jsx)("meshBasicMaterial",{color:"#FFFF99",fog:!1}),Object(c.jsx)("pointLight",{distance:6100,intensity:10,color:"white"}),"1"]})})}function b(){var e=Object(a.useRef)(),t=Object(u.d)(j.TextureLoader,[m,h,d]),r=Object(l.a)(t,3),n=r[0],o=r[1];r[2];return Object(u.c)((function(t,r){return e.current.rotation.y+=.01})),Object(c.jsxs)("group",{ref:e,scale:[200,200,200],position:[-4e3,0,4e3],children:[Object(c.jsxs)("mesh",{position:[0,0,0],children:[Object(c.jsx)("sphereGeometry",{args:[5,32,32]}),Object(c.jsx)("meshStandardMaterial",{map:n,roughness:1,fog:!1})]}),Object(c.jsxs)("mesh",{position:[5,0,5],children:[Object(c.jsx)("sphereGeometry",{args:[.75,32,32]}),Object(c.jsx)("meshStandardMaterial",{roughness:1,map:o,fog:!1})]})]})}function f(){var e=Object(a.useRef)(),t=Object(u.d)(j.TextureLoader,[m,h,d]),r=Object(l.a)(t,3),n=(r[0],r[1],r[2]);return Object(u.c)((function(){return e.current.rotation.y=e.current.rotation.y+.01})),Object(c.jsx)("group",{ref:e,scale:[100,100,100],position:[5e3,0,-5e3],children:Object(c.jsxs)("mesh",{position:[0,0,0],children:[Object(c.jsx)("sphereGeometry",{args:[5,32,32]}),Object(c.jsx)("meshStandardMaterial",{map:n,roughness:1,fog:!1})]})})}var O=r(14),x=r(9),g=r(41),y=r(42),v=r.n(y),M=r.p+"static/media/laser.373d639d.mp3",w=r.p+"static/media/engine.75bbe12e.mp3",S=r.p+"static/media/engine2.87c3c40a.mp3",P=r.p+"static/media/bg.898c3fe7.mp3",A=r.p+"static/media/warp.1f9bec85.mp3",k=r.p+"static/media/click.db461987.mp3",R=r.p+"static/media/explosion.615cfd43.mp3",T=new Audio(M),B=new Audio(w),G=new Audio(S),z=new Audio(P),L=new Audio(A),D=new Audio(k),I=(new Audio(R),1),V=v()((function(e,t){var r=new g.a.GrannyKnot,n=new j.TubeBufferGeometry(r,250,.2,10,!0),o=void 0,a=void 0,i=new j.Box3;return{sound:!1,camera:void 0,points:0,health:100,lasers:[],explosions:[],rocks:E(100,n,150,8,(function(){return 1+2.5*Math.random()})),enemies:E(10,n,20,15,1),mutation:{t:0,position:new j.Vector3,startTime:Date.now(),track:n,scale:15,fov:70,hits:!1,rings:F(30,n),particles:E(1500,n,100,1,(function(){return.5+.8*Math.random()})),looptime:4e4,binormal:new j.Vector3,normal:new j.Vector3,clock:new j.Clock(!1),mouse:new j.Vector2(-250,50),dummy:new j.Object3D,ray:new j.Ray,box:new j.Box3},actions:{init:function(r){var o=t(),i=o.mutation,c=o.actions;e({camera:r}),i.clock.start(),c.toggleSound(t().sound),Object(u.b)((function(){var r=t(),o=r.rocks,s=r.enemies,u=Date.now(),l=i.t=(u-i.startTime)%i.looptime/i.looptime;i.position=n.parameters.path.getPointAt(l),i.position.multiplyScalar(i.scale);var j=!1;l>.3&&l<.4?j||(j=!0,C(L)):l>.5&&(j=!1);var m=o.filter(c.test),h=s.filter(c.test),d=m.concat(h),p=i.hits;i.hits=d.length,0===p&&i.hits&&C(D);var b=t().lasers;if(i.hits&&b.length&&u-b[b.length-1]<100){var f=d.map((function(e){return Object(x.a)({time:Date.now()},e)}));e((function(e){return{explosions:[].concat(Object(O.a)(e.explosions),Object(O.a)(f))}})),clearTimeout(a),a=setTimeout((function(){return e((function(e){return{explosions:e.explosions.filter((function(e){var t=e.time;return Date.now()-t<=1e3}))}}))}),1e3),e((function(e){return{points:e.points+100*m.length+200*h.length,rocks:e.rocks.filter((function(e){return!m.find((function(t){return t.guid===e.guid}))})),enemies:e.enemies.filter((function(e){return!h.find((function(t){return t.guid===e.guid}))}))}}))}}))},shoot:function(){e((function(e){return{lasers:[].concat(Object(O.a)(e.lasers),[Date.now()])}})),clearTimeout(o),o=setTimeout((function(){return e((function(e){return{lasers:e.lasers.filter((function(e){return Date.now()-e<=1e3}))}}))}),1e3),C(T,.5)},toggleSound:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!t().sound;e({sound:r}),C(B,1,!0),C(G,.3,!0),C(z,1,!0)},updateMouse:function(e){var r=e.clientX,n=e.clientY;t().mutation.mouse.set(r-window.innerWidth/2,n-window.innerHeight/2)},test:function(e){i.min.copy(e.offset),i.max.copy(e.offset),i.expandByScalar(e.size*e.scale),e.hit.set(1e4,1e4,1e4);var r=t().mutation.ray.intersectBox(i,e.hit);return e.distance=t().mutation.ray.origin.distanceTo(e.hit),r}}}}));function E(e,t,r,n,o){return new Array(e).fill().map((function(){var e=Math.random(),a=t.parameters.path.getPointAt(e);a.multiplyScalar(15);var i=a.clone().add(new j.Vector3(-r+Math.random()*r*2,-r+Math.random()*r*2,-r+Math.random()*r*2)),c=.1+Math.random();return{guid:I++,scale:"function"===typeof o?o():o,size:n,offset:i,pos:a,speed:c,radius:r,t:e,hit:new j.Vector3,distance:1e3}}))}function F(e,t){for(var r=[],n=.4,o=0;o<e;o++){n+=.003;var a=t.parameters.path.getPointAt(n);a.multiplyScalar(15);var i=n*t.tangents.length,c=Math.floor(i),s=t.parameters.path.getPointAt((n+1/t.parameters.path.getLength())%1).multiplyScalar(15),u=(new j.Matrix4).lookAt(a,s,t.binormals[c]);r.push([a.toArray(),u])}return r}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];V.getState().sound?(e.currentTime=0,e.volume=t,e.loop=r,e.play()):e.pause()}var W=V,q=0;function H(e){var t=e.children,r=Object(a.useRef)(),n=Object(a.useRef)(),o=W((function(e){return e.mutation})),i=o.fov,s=o.scale,l=o.binormal,j=o.normal,m=o.track,h=o.mouse,d=Object(u.e)().camera;return Object(u.c)((function(){var e=o.t,t=o.position.clone(),n=m.tangents.length,a=e*n,c=Math.floor(a),u=(c+1)%n;l.subVectors(m.binormals[u],m.binormals[c]),l.multiplyScalar(a-c).add(m.binormals[c]);var p=m.parameters.path.getTangentAt(e);q+=.05*(Math.max(15,15+-h.y/20)-q),j.copy(l).cross(p),t.add(j.clone().multiplyScalar(q)),d.position.copy(t);var b=m.parameters.path.getPointAt((e+30/m.parameters.path.getLength())%1).multiplyScalar(s);d.matrix.lookAt(d.position,b,j),d.quaternion.setFromRotationMatrix(d.matrix),d.fov+=.05*((e>.4&&e<.45?120:i)-d.fov),d.updateProjectionMatrix();var f=m.parameters.path.getPointAt((e+1/m.parameters.path.getLength())%1).multiplyScalar(s);r.current.position.copy(f),r.current.quaternion.setFromRotationMatrix(d.matrix)})),Object(c.jsxs)("group",{ref:r,children:[Object(c.jsx)("pointLight",{distance:400,position:[0,100,-420],intensity:5,color:"indianred"}),Object(c.jsx)("group",{ref:n,position:[0,0,-50],children:t})]})}r(35);var J=r(54),X=new j.BoxBufferGeometry(1,1,40),Y=new j.Color("lightgreen"),K=new j.Color("hotpink"),U=new j.MeshBasicMaterial({color:Y}),_=new j.MeshBasicMaterial({color:K,fog:!1}),N=new j.Vector3,Q=new j.Vector3;function Z(){var e=Object(J.a)("/psychespacecraft2.glb"),t=e.nodes,r=e.materials,n=W((function(e){return e.mutation})),o=n.clock,i=n.mouse,s=n.ray,l=W((function(e){return e.lasers})),j=Object(a.useRef)(),m=Object(a.useRef)(),h=Object(a.useRef)(),d=Object(a.useRef)(),p=Object(a.useRef)(),b=Object(a.useRef)();return Object(u.c)((function(){j.current.position.z=Math.sin(40*o.getElapsedTime())*Math.PI*.2,j.current.rotation.z+=.2*(i.x/500-j.current.rotation.z),j.current.rotation.x+=.2*(-i.y/1200-j.current.rotation.x),j.current.rotation.y+=.2*(-i.x/1200-j.current.rotation.y),j.current.position.x+=.2*(i.x/10-j.current.position.x),j.current.position.y+=.2*(25+-i.y/10-j.current.position.y),d.current.scale.x=1+Math.sin(200*o.getElapsedTime()),d.current.scale.y=1+Math.sin(200*o.getElapsedTime());for(var e=0;e<l.length;e++){m.current.children[e].position.z-=20}h.current.intensity+=.3*((l.length&&Date.now()-l[l.length-1]<100?20:0)-h.current.intensity),j.current.getWorldPosition(N),j.current.getWorldDirection(Q),s.origin.copy(N),s.direction.copy(Q.negate()),_.color=n.hits?Y:K,p.current.visible=!n.hits,b.current.visible=!!n.hits})),Object(c.jsxs)("group",{ref:j,children:[Object(c.jsxs)("group",{scale:[.5,.5,.5],children:[Object(c.jsx)("group",{ref:p,position:[0,0,-300],name:"cross"}),Object(c.jsxs)("group",{ref:b,position:[0,0,-300],name:"target",children:[Object(c.jsx)("mesh",{position:[0,20,0],renderOrder:1e3,material:_,children:Object(c.jsx)("boxGeometry",{args:[40,2,2]})}),Object(c.jsx)("mesh",{position:[0,-20,0],renderOrder:1e3,material:_,children:Object(c.jsx)("boxGeometry",{args:[40,2,2]})}),Object(c.jsx)("mesh",{position:[20,0,0],renderOrder:1e3,material:_,children:Object(c.jsx)("boxGeometry",{args:[2,40,2]})}),Object(c.jsx)("mesh",{position:[-20,0,0],renderOrder:1e3,material:_,children:Object(c.jsx)("boxGeometry",{args:[2,40,2]})})]}),Object(c.jsx)("pointLight",{ref:h,position:[0,0,-20],distance:100,intensity:0,color:"lightgreen"}),Object(c.jsx)("group",{ref:m,children:l.map((function(e,t){return Object(c.jsxs)("group",{children:[Object(c.jsx)("mesh",{position:[-2.8,0,-.8],geometry:X,material:U}),Object(c.jsx)("mesh",{position:[2.8,0,-.8],geometry:X,material:U})]},t)}))}),Object(c.jsxs)("group",{rotation:[Math.PI/2,Math.PI,0],children:[Object(c.jsx)("mesh",{name:"Psyche",castShadow:!0,receiveShadow:!0,geometry:t.Psyche.geometry,material:t.Psyche.material}),Object(c.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:t.Psyche001.geometry,material:t.Psyche001.material}),Object(c.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:t.Psyche002.geometry,material:r["Material.002"]})]})]}),Object(c.jsxs)("mesh",{ref:d,scale:[1,1,30],position:[0,1,30],children:[Object(c.jsx)("dodecahedronBufferGeometry",{args:[1.5,0]}),Object(c.jsx)("meshBasicMaterial",{color:"lightblue"})]})]})}var $=r(15),ee=r(55),te=["color","size","scale","children"],re=["camera"];function ne(e){var t=e.color,r=e.size,n=e.scale,o=e.children,a=Object($.a)(e,te);return Object(c.jsxs)("mesh",Object(x.a)(Object(x.a)({scale:n},a),{},{children:[Object(c.jsx)("boxBufferGeometry",{attach:"geometry",args:r}),Object(c.jsx)("meshPhongMaterial",{attach:"material",color:t}),o]}))}function oe(e){var t=e.camera,r=Object($.a)(e,re),n=Object(a.useState)(!1),o=Object(l.a)(n,2),s=o[0],u=o[1],j=Object(a.useState)("blue"),m=Object(l.a)(j,2),h=m[0],d=m[1],p=Object(a.useState)([.4,.1,.1]),b=Object(l.a)(p,2),f=b[0],O=b[1],g=Object(a.useState)("Start Psyche Express!"),y=Object(l.a)(g,2),v=y[0],M=y[1],w=W((function(e){return e.actions}));return Object(c.jsx)(i.c,{onHover:function(){return u(!0)},onBlur:function(){return u(!1)},onSelect:function(){d(16777215*Math.random()|0),O([0,0,0]),M(""),w.init(t)},children:Object(c.jsx)(ne,Object(x.a)(Object(x.a)({color:h,scale:s?[.6,.6,.6]:[.5,.5,.5],size:f},r),{},{children:Object(c.jsx)(ee.a,{position:[0,0,.06],fontSize:.03,color:"#fff",anchorX:"center",anchorY:"middle",children:v})}))})}function ae(){var e=Object(a.useRef)(),t=Object(J.a)("/PsycheAsteroid1.glb"),r=t.nodes,n=t.materials;return Object(u.c)((function(){return e.current.rotation.x=e.current.rotation.x+.1})),Object(c.jsx)("group",{ref:e,scale:[500,500,500],position:[6e3,0,6e3],children:Object(c.jsx)("mesh",{geometry:r.psyche_LP001.geometry,material:n.psycheAsteroid,rotation:[Math.PI/2,0,0]})})}function ie(){var e=Object(a.useRef)();return Object(u.c)((function(t,r){return e.current.rotation.y+=.01})),Object(c.jsxs)("group",{ref:e,scale:[1,1,1],position:[0,0,0],children:[Object(c.jsx)(p,{}),Object(c.jsx)(b,{}),Object(c.jsx)(f,{}),Object(c.jsx)(ae,{}),Object(c.jsxs)(H,{children:[Object(c.jsx)(Z,{}),Object(c.jsx)(oe,{})]})]})}function ce(){var e=Object(a.useRef)(),t=W((function(e){return e.mutation})),r=t.particles,n=t.dummy;return Object(a.useEffect)((function(){r.forEach((function(t,r){var o=t.offset,a=t.scale;n.position.copy(o),n.scale.set(a,a,a),n.rotation.set(Math.sin(Math.random())*Math.PI,Math.sin(Math.random())*Math.PI,Math.cos(Math.random())*Math.PI),n.updateMatrix(),e.current.setMatrixAt(r,n.matrix)})),e.current.instanceMatrix.needsUpdate=!0}),[]),Object(c.jsxs)("instancedMesh",{ref:e,args:[null,null,r.length],frustumCulled:!1,children:[Object(c.jsx)("coneGeometry",{args:[2,2,3]}),Object(c.jsx)("meshStandardMaterial",{color:"#606060"})]})}function se(){W((function(e){return e.actions}));var e=W((function(e){return e.mutation})),t=e.fov;e.position;function r(){return Object(c.jsx)(a.Suspense,{fallback:null,children:Object(c.jsx)(ie,{})})}return Object(c.jsxs)(i.a,{gl:{antialias:!1},camera:{position:[-5e3,0,5e3],near:.01,far:1e5,fov:t},children:[" ",Object(c.jsx)("ambientLight",{intensity:.25}),Object(c.jsx)(r,{}),Object(c.jsx)(oe,{camera:{position:[-5e3,0,5e3],near:.01,far:1e5,fov:t}}),Object(c.jsx)(i.b,{}),Object(c.jsx)(ce,{}),Object(c.jsx)(s,{})]})}o.a.render(Object(c.jsx)(se,{}),document.getElementById("root"))}},[[52,1,2]]]);
//# sourceMappingURL=main.a4e597d9.chunk.js.map