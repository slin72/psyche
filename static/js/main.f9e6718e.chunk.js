(this["webpackJsonpspace-game"]=this["webpackJsonpspace-game"]||[]).push([[0],{46:function(e,t,r){},52:function(t,n,o){"use strict";o.r(n);var i=o(38),c=o.n(i),s=o(6),u=o(25),l=(o(46),o(5));function j(e){var t=e.count,r=void 0===t?2e3:t,n=Object(s.useMemo)((function(){for(var e=[],t=0;t<r;t++){var n=4e3,o=2*Math.PI*Math.random(),a=Math.acos(2*Math.random()-1),i=n*Math.cos(o)*Math.sin(a)+(4e3*Math.random()-2e3),c=n*Math.sin(o)*Math.sin(a)+(4e3*Math.random()-2e3),s=n*Math.cos(a)+(2e3*Math.random()-1e3);e.push(i),e.push(c),e.push(s)}return new Float32Array(e)}),[r]);return Object(l.jsxs)("points",{children:[Object(l.jsx)("bufferGeometry",{children:Object(l.jsx)("bufferAttribute",{attachObject:["attributes","position"],count:n.length/3,array:n,itemSize:3})}),Object(l.jsx)("pointsMaterial",{size:15,sizeAttenuation:!0,color:"white",fog:!1})]})}var h=o(11);function m(){var e=Object(s.useRef)();return Object(h.c)((function(){return e.current.rotation.y=e.current.rotation.y+.01})),Object(l.jsx)("group",{ref:e,scale:[100,100,100],position:[0,0,0],children:Object(l.jsxs)("mesh",{position:[0,0,0],children:[Object(l.jsx)("sphereGeometry",{args:[4,32,32]}),Object(l.jsx)("meshBasicMaterial",{color:"#FFFF99",fog:!1}),Object(l.jsx)("pointLight",{distance:6100,intensity:10,color:"white"}),"1"]})})}var p=o(10),d=o(0),b=o(15),f=o(9),O=o(42),g=o(33),x=o.n(g),y=o.p+"static/media/laser.373d639d.mp3",v=o.p+"static/media/engine.75bbe12e.mp3",M=o.p+"static/media/engine2.87c3c40a.mp3",w=o.p+"static/media/bg.c6b2b728.mp3",S=o.p+"static/media/warp.1f9bec85.mp3",P=o.p+"static/media/click.db461987.mp3",A=o.p+"static/media/explosion.615cfd43.mp3",k=(new Audio(y),new Audio(v)),B=(new Audio(M),new Audio(w)),R=(new Audio(S),new Audio(P),new Audio(A),1),G=x()((function(t,n){var o=new O.a.GrannyKnot,i=new d.TubeBufferGeometry(o,250,.2,10,!0),c=void 0,s=void 0,u=new d.Box3;return{sound:!1,camera:void 0,points:0,health:100,lasers:[],explosions:[],rocks:T(100,i,150,8,(function(){return 1+2.5*Math.random()})),enemies:T(10,i,20,15,1),mutation:{t:0,position:new d.Vector3,startTime:Date.now(),track:i,scale:15,fov:70,hits:!1,rings:z(30,i),particles:T(1500,i,100,1,(function(){return.5+.8*Math.random()})),looptime:4e4,binormal:new d.Vector3,normal:new d.Vector3,clock:new d.Clock(!1),mouse:new d.Vector2(-250,50),dummy:new d.Object3D,ray:new d.Ray,box:new d.Box3},actions:{init:function(o){var c=n(),u=c.mutation,l=c.actions;t({camera:o}),u.clock.start(),l.toggleSound(n().sound),Object(h.b)((function(){var o=n(),c=(o.rocks,o.enemies,Date.now()),l=u.t=(c-u.startTime)%u.looptime/u.looptime;u.position=i.parameters.path.getPointAt(l),u.position.multiplyScalar(u.scale);var j=!1;l>.3&&l<.4?j||(j=!0):l>.5&&(j=!1);u.hits;var h=n().lasers;if(u.hits&&h.length&&c-h[h.length-1]<100){var m=a.map((function(e){return Object(f.a)({time:Date.now()},e)}));t((function(e){return{explosions:[].concat(Object(b.a)(e.explosions),Object(b.a)(m))}})),clearTimeout(s),s=setTimeout((function(){return t((function(e){return{explosions:e.explosions.filter((function(e){var t=e.time;return Date.now()-t<=1e3}))}}))}),1e3),t((function(t){return{points:t.points+100*r.length+200*e.length,rocks:t.rocks.filter((function(e){return!r.find((function(t){return t.guid===e.guid}))})),enemies:t.enemies.filter((function(t){return!e.find((function(e){return e.guid===t.guid}))}))}}))}}))},shoot:function(){t((function(e){return{lasers:[].concat(Object(b.a)(e.lasers),[Date.now()])}})),clearTimeout(c),c=setTimeout((function(){return t((function(e){return{lasers:e.lasers.filter((function(e){return Date.now()-e<=1e3}))}}))}),1e3)},toggleSound:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!n().sound;t({sound:e}),V(k,1,!0),V(B,1,!0)},updateMouse:function(e){var t=e.clientX,r=e.clientY;n().mutation.mouse.set(t-window.innerWidth/2,r-window.innerHeight/2)},test:function(e){u.min.copy(e.offset),u.max.copy(e.offset),u.expandByScalar(e.size*e.scale),e.hit.set(1e4,1e4,1e4);var t=n().mutation.ray.intersectBox(u,e.hit);return e.distance=n().mutation.ray.origin.distanceTo(e.hit),t}}}}));function T(e,t,r,n,o){return new Array(e).fill().map((function(){var e=Math.random(),a=t.parameters.path.getPointAt(e);a.multiplyScalar(15);var i=a.clone().add(new d.Vector3(-r+Math.random()*r*2,-r+Math.random()*r*2,-r+Math.random()*r*2)),c=.1+Math.random();return{guid:R++,scale:"function"===typeof o?o():o,size:n,offset:i,pos:a,speed:c,radius:r,t:e,hit:new d.Vector3,distance:1e3}}))}function z(e,t){for(var r=[],n=.4,o=0;o<e;o++){n+=.003;var a=t.parameters.path.getPointAt(n);a.multiplyScalar(15);var i=n*t.tangents.length,c=Math.floor(i),s=t.parameters.path.getPointAt((n+1/t.parameters.path.getLength())%1).multiplyScalar(15),u=(new d.Matrix4).lookAt(a,s,t.binormals[c]);r.push([a.toArray(),u])}return r}function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];G.getState().sound?(e.currentTime=0,e.volume=t,e.loop=r,e.play()):e.pause()}var L=G,D=o.p+"static/media/earth.117f05cb.jpg",I=o.p+"static/media/moon.1dd7bdd6.png",F=o.p+"static/media/mars.d5a1f3ac.jpg",C=o(17),E=o(54),W=["color","size","scale","children"],q=["camera"];function H(e){var t=e.color,r=e.size,n=e.scale,o=e.children,a=Object(C.a)(e,W);return Object(l.jsxs)("mesh",Object(f.a)(Object(f.a)({scale:n},a),{},{children:[Object(l.jsx)("boxBufferGeometry",{attach:"geometry",args:r}),Object(l.jsx)("meshPhongMaterial",{attach:"material",color:t}),o]}))}function J(e){var t=e.camera,r=Object(C.a)(e,q),n=Object(s.useState)(!1),o=Object(p.a)(n,2),a=o[0],i=o[1],c=Object(s.useState)("blue"),j=Object(p.a)(c,2),h=j[0],m=j[1],d=Object(s.useState)([.4,.1,.1]),b=Object(p.a)(d,2),O=b[0],g=b[1],x=Object(s.useState)("Press and Track Psyche"),y=Object(p.a)(x,2),v=y[0],M=y[1],w=L((function(e){return e.actions})),S=L((function(e){return e.actions.toggleSound}));return Object(l.jsx)(u.c,{onHover:function(){return i(!0)},onBlur:function(){return i(!1)},onSelect:function(){m(16777215*Math.random()|0),g([0,0,0]),M(""),w.init(t),S()},children:Object(l.jsx)(H,Object(f.a)(Object(f.a)({rotation:[0,90,0],color:h,scale:a?[.6,.6,.6]:[.5,.5,.5],size:O},r),{},{children:Object(l.jsx)(E.a,{position:[0,0,.06],fontSize:.03,color:"#000",anchorX:"center",anchorY:"middle",children:v})}))})}function X(){var e=Object(s.useRef)(),t=Object(h.d)(d.TextureLoader,[D,I,F]),r=Object(p.a)(t,3),n=r[0],o=r[1];r[2];Object(h.c)((function(t,r){return e.current.rotation.y+=.01}));var a=L((function(e){return e.mutation})),i=a.fov;a.position;return Object(l.jsxs)("group",{ref:e,scale:[200,200,200],position:[-4e3,0,4e3],children:[Object(l.jsx)(J,{position:[10,0,-10],camera:{position:[-5e3,0,5e3],near:.01,far:1e5,fov:i}}),Object(l.jsxs)("mesh",{position:[0,0,0],children:[Object(l.jsx)("sphereGeometry",{args:[5,32,32]}),Object(l.jsx)("meshStandardMaterial",{map:n,roughness:1,fog:!1})]}),Object(l.jsxs)("mesh",{position:[5,0,5],children:[Object(l.jsx)("sphereGeometry",{args:[.75,32,32]}),Object(l.jsx)("meshStandardMaterial",{roughness:1,map:o,fog:!1})]})]})}function Y(){var e=Object(s.useRef)(),t=Object(h.d)(d.TextureLoader,[F]),r=Object(p.a)(t,1)[0];return Object(h.c)((function(){return e.current.rotation.y=e.current.rotation.y+.01})),Object(l.jsx)("group",{ref:e,scale:[100,100,100],position:[5e3,0,-5e3],children:Object(l.jsxs)("mesh",{position:[0,0,0],children:[Object(l.jsx)("sphereGeometry",{args:[5,32,32]}),Object(l.jsx)("meshStandardMaterial",{map:r,roughness:1,fog:!1})]})})}var K=0;function U(e){var t=e.children,r=Object(s.useRef)(),n=Object(s.useRef)(),o=L((function(e){return e.mutation})),a=o.fov,i=o.scale,c=o.binormal,u=o.normal,j=o.track,m=o.mouse,p=Object(h.e)().camera;return Object(h.c)((function(){var e=o.t,t=o.position.clone(),n=j.tangents.length,s=e*n,l=Math.floor(s),h=(l+1)%n;c.subVectors(j.binormals[h],j.binormals[l]),c.multiplyScalar(s-l).add(j.binormals[l]);var d=j.parameters.path.getTangentAt(e);K+=.05*(Math.max(15,15+-m.y/20)-K),u.copy(c).cross(d),t.add(u.clone().multiplyScalar(K)),p.position.copy(t);var b=j.parameters.path.getPointAt((e+30/j.parameters.path.getLength())%1).multiplyScalar(i);p.matrix.lookAt(p.position,b,u),p.quaternion.setFromRotationMatrix(p.matrix),p.fov+=.05*((e>.4&&e<.45?120:a)-p.fov),p.updateProjectionMatrix();var f=j.parameters.path.getPointAt((e+1/j.parameters.path.getLength())%1).multiplyScalar(i);r.current.position.copy(f),r.current.quaternion.setFromRotationMatrix(p.matrix)})),Object(l.jsxs)("group",{ref:r,children:[Object(l.jsx)("pointLight",{distance:400,position:[0,100,-420],intensity:5,color:"indianred"}),Object(l.jsx)("group",{ref:n,position:[0,0,-50],children:t})]})}o(35),new d.BoxBufferGeometry(1,1,40);var _=new d.Color("lightgreen"),N=new d.Color("hotpink");new d.MeshBasicMaterial({color:_}),new d.MeshBasicMaterial({color:N,fog:!1}),new d.Vector3,new d.Vector3;var Q=o(55),Z=new d.BoxBufferGeometry(1,1,40),$=new d.Color("lightgreen"),ee=new d.Color("hotpink"),te=new d.MeshBasicMaterial({color:$}),re=new d.MeshBasicMaterial({color:ee,fog:!1}),ne=new d.Vector3,oe=new d.Vector3;function ae(){var e=Object(Q.a)("/psyche/psychespacecraft2.glb"),t=e.nodes,r=e.materials,n=L((function(e){return e.mutation})),o=n.clock,a=n.mouse,i=n.ray,c=L((function(e){return e.lasers})),u=Object(s.useRef)(),j=Object(s.useRef)(),m=Object(s.useRef)(),p=Object(s.useRef)(),d=Object(s.useRef)(),b=Object(s.useRef)();return Object(h.c)((function(){u.current.position.z=Math.sin(40*o.getElapsedTime())*Math.PI*.2,u.current.rotation.z+=.2*(a.x/500-u.current.rotation.z),u.current.rotation.x+=.2*(-a.y/1200-u.current.rotation.x),u.current.rotation.y+=.2*(-a.x/1200-u.current.rotation.y),u.current.position.x+=.2*(a.x/10-u.current.position.x),u.current.position.y+=.2*(25+-a.y/10-u.current.position.y),p.current.scale.x=1+Math.sin(200*o.getElapsedTime()),p.current.scale.y=1+Math.sin(200*o.getElapsedTime());for(var e=0;e<c.length;e++){j.current.children[e].position.z-=20}m.current.intensity+=.3*((c.length&&Date.now()-c[c.length-1]<100?20:0)-m.current.intensity),u.current.getWorldPosition(ne),u.current.getWorldDirection(oe),i.origin.copy(ne),i.direction.copy(oe.negate()),re.color=n.hits?$:ee,d.current.visible=!n.hits,b.current.visible=!!n.hits})),Object(l.jsxs)("group",{ref:u,children:[Object(l.jsxs)("group",{scale:[.5,.5,.5],children:[Object(l.jsx)("group",{ref:d,position:[0,0,-300],name:"cross"}),Object(l.jsxs)("group",{ref:b,position:[0,0,-300],name:"target",children:[Object(l.jsx)("mesh",{position:[0,20,0],renderOrder:1e3,material:re,children:Object(l.jsx)("boxGeometry",{args:[40,2,2]})}),Object(l.jsx)("mesh",{position:[0,-20,0],renderOrder:1e3,material:re,children:Object(l.jsx)("boxGeometry",{args:[40,2,2]})}),Object(l.jsx)("mesh",{position:[20,0,0],renderOrder:1e3,material:re,children:Object(l.jsx)("boxGeometry",{args:[2,40,2]})}),Object(l.jsx)("mesh",{position:[-20,0,0],renderOrder:1e3,material:re,children:Object(l.jsx)("boxGeometry",{args:[2,40,2]})})]}),Object(l.jsx)("pointLight",{ref:m,position:[0,0,-20],distance:100,intensity:0,color:"lightgreen"}),Object(l.jsx)("group",{ref:j,children:c.map((function(e,t){return Object(l.jsxs)("group",{children:[Object(l.jsx)("mesh",{position:[-2.8,0,-.8],geometry:Z,material:te}),Object(l.jsx)("mesh",{position:[2.8,0,-.8],geometry:Z,material:te})]},t)}))}),Object(l.jsxs)("group",{rotation:[Math.PI/2,Math.PI,0],children:[Object(l.jsx)("mesh",{name:"Psyche",castShadow:!0,receiveShadow:!0,geometry:t.Psyche.geometry,material:t.Psyche.material}),Object(l.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:t.Psyche001.geometry,material:t.Psyche001.material}),Object(l.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:t.Psyche002.geometry,material:r["Material.002"]})]})]}),Object(l.jsxs)("mesh",{ref:p,scale:[1,1,30],position:[0,1,30],children:[Object(l.jsx)("dodecahedronBufferGeometry",{args:[1.5,0]}),Object(l.jsx)("meshBasicMaterial",{color:"lightblue"})]})]})}function ie(){var e=Object(s.useRef)(),t=Object(Q.a)("/psyche/PsycheAsteroid1.glb"),r=t.nodes,n=t.materials;return Object(h.c)((function(){return e.current.rotation.x+=.1})),Object(l.jsx)("group",{ref:e,scale:[300,300,300],position:[6e3,0,6e3],children:Object(l.jsx)("mesh",{geometry:r.psyche_LP001.geometry,material:n.psycheAsteroid,rotation:[Math.PI/2,0,0]})})}function ce(){var e=Object(s.useRef)(),t=L((function(e){return e.mutation})),r=t.fov;t.position;return Object(h.c)((function(t,r){return e.current.rotation.y+=.01})),Object(l.jsxs)("group",{ref:e,scale:[1,1,1],position:[0,0,0],children:[Object(l.jsx)(m,{}),Object(l.jsx)(J,{scale:[10,10,10],position:[-10,0,10],camera:{position:[-5e3,0,5e3],near:.01,far:1e5,fov:r}}),Object(l.jsx)(X,{}),Object(l.jsx)(Y,{}),Object(l.jsx)(ie,{}),Object(l.jsx)(U,{children:Object(l.jsx)(ae,{})})]})}function se(){var e=Object(s.useRef)(),t=L((function(e){return e.mutation})),r=t.particles,n=t.dummy;return Object(s.useEffect)((function(){r.forEach((function(t,r){var o=t.offset,a=t.scale;n.position.copy(o),n.scale.set(a,a,a),n.rotation.set(Math.sin(Math.random())*Math.PI,Math.sin(Math.random())*Math.PI,Math.cos(Math.random())*Math.PI),n.updateMatrix(),e.current.setMatrixAt(r,n.matrix)})),e.current.instanceMatrix.needsUpdate=!0}),[]),Object(l.jsxs)("instancedMesh",{ref:e,args:[null,null,r.length],frustumCulled:!1,children:[Object(l.jsx)("coneGeometry",{args:[2,2,3]}),Object(l.jsx)("meshStandardMaterial",{color:"#606060"})]})}function ue(){L((function(e){return e.actions}));var e=L((function(e){return e.mutation})),t=e.fov;e.position;function r(){return Object(l.jsx)(s.Suspense,{fallback:null,children:Object(l.jsx)(ce,{})})}return Object(l.jsxs)(u.a,{gl:{antialias:!1},camera:{position:[-5e3,0,5e3],near:.01,far:1e5,fov:t},children:[" ",Object(l.jsx)("ambientLight",{intensity:.25}),Object(l.jsx)(r,{}),Object(l.jsx)(u.b,{}),Object(l.jsx)(se,{}),Object(l.jsx)(j,{})]})}c.a.render(Object(l.jsx)(ue,{}),document.getElementById("root"))}},[[52,1,2]]]);
//# sourceMappingURL=main.f9e6718e.chunk.js.map